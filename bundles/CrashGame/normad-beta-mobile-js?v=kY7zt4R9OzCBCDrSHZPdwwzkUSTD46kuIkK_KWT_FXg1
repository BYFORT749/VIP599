$(()=>{const n=document.getElementById("game_list"),t=()=>{n&&(n.onclick=n=>{if(n.target.className==="favourite-game-btn"){let t="";t=n.target.checked?"/game/new-favourite":"/game/remove-favourite";$.ajax({type:"POST",data:JSON.stringify({Provider:n.target.dataset.provider,GameCode:n.target.value}),url:t,contentType:"application/json; charset=utf-8",dataType:"json",success:t=>{t.errorCode!=0&&(n.target.checked=!n.target.checked,registerPopup({content:`Unable to update favourite game. ${t.message}`}))},error:()=>{n.target.checked=!n.target.checked,registerPopup({content:"Unable to update favourite game."})}})}})};t()});
$(()=>{const n=document.querySelector("#filter_categories"),r=document.querySelector("#filter_input"),t=document.querySelector("#game_list"),i=document.querySelector("#game_modal"),u=document.querySelector("#game_modal_image"),e=document.querySelector("#game_modal_name"),f=document.querySelector("#game_modal_links"),o=document.querySelector(".provider-section");window.initializeCrashGameGames=s=>{$.ajax({type:"GET",url:`/mobile/crash-game/games/${s.provider}`,contentType:"application/json; charset=utf-8",dataType:"json",success:h=>{const c=84,l=89,v=new Set,y=document.createDocumentFragment();h.forEach(n=>{v.add(n.category);const p=document.createElement("img");p.src=`${s.directoryPath}${s.provider}/${n.gameImage}`;p.alt=n.name;const h=document.createElement("div");if(h.className="wrapper-container",h.appendChild(p),n.rtpChanged!==null&&isFinite(n.rtpChanged.from)&&isFinite(n.rtpChanged.to)){const u=document.createElement("span");u.className="rtp-title";u.innerText="RTP";const t=document.createElement("div"),f=n.rtpChanged.from.toFixed(2),o=n.rtpChanged.to.toFixed(2);t.className="rtp-progress-bar";t.dataset.rtpFrom=f;t.dataset.rtpTo=o;t.style.width=f+"%";t.style.setProperty("--from-value",`${f}%`);t.style.setProperty("--to-value",`${o}%`);n.rtpChanged.from<c&&t.style.setProperty("--from-color","var(--low)");n.rtpChanged.from>=c&&n.rtpChanged.from<=l&&t.style.setProperty("--from-color","var(--medium)");n.rtpChanged.from>l&&t.style.setProperty("--from-color","var(--high)");n.rtpChanged.to<c&&t.style.setProperty("--to-color","var(--low)");n.rtpChanged.to>=c&&n.rtpChanged.to<=l&&t.style.setProperty("--to-color","var(--medium)");n.rtpChanged.to>l&&t.style.setProperty("--to-color","var(--high)");t.dataset.rtpFrom!="medium"&&t.dataset.rtpTo!="medium"?t.style.setProperty("--transition-color","var(--medium)"):t.style.setProperty("--transition-color","var(--from-color)");const e=document.createElement("div");e.className="rtp-progress";e.appendChild(t);const r=document.createElement("span");r.className="rtp-percentage";r.dataset.rtpFrom=Math.ceil(n.rtpChanged.from);r.dataset.rtpTo=Math.ceil(n.rtpChanged.to);const i=document.createElement("div");i.className="rtp-container";i.appendChild(u);i.appendChild(e);i.appendChild(r);h.appendChild(i)}else if(n.rtpValue!==null&&isFinite(n.rtpValue)){const r=document.createElement("span");r.className="rtp-title";r.innerText="RTP";const t=document.createElement("div");t.className="rtp-progress-bar";t.style.width=n.rtpValue.toFixed(2)+"%";n.rtpValue<c&&(t.dataset.rtp="low");n.rtpValue>=c&&n.rtpValue<=l&&(t.dataset.rtp="medium");n.rtpValue>l&&(t.dataset.rtp="high");const u=document.createElement("div");u.className="rtp-progress";u.appendChild(t);const f=document.createElement("span");f.className="rtp-percentage";f.innerHTML=Math.ceil(n.rtpValue)+"%";const i=document.createElement("div");i.className="rtp-container";i.appendChild(r);i.appendChild(u);i.appendChild(f);h.appendChild(i)}const a=document.createElement("div");a.className="game-name-container";const w=document.createElement("div");w.className="game-name";w.innerText=n.name;a.appendChild(w);const r=document.createElement("li");if(r.className="game-item",r.dataset.game=n.name,r.dataset.category=n.category,n.isFavourite!==undefined&&n.isFavourite!==null){const t=document.createElement("input");t.type="checkbox";t.dataset.provider=s.provider;t.value=n.gameCode;t.id=n.gameCode;t.className="favourite-game-btn";n.isFavourite&&(t.checked=!0);const u=document.createElement("label");u.htmlFor=n.gameCode;i&&!o?(a.appendChild(t),a.appendChild(u)):(r.appendChild(t),r.appendChild(u))}if(i)h.onclick=()=>{if(t.dataset.isLoggedIn==="true")window.location.href=n.link;else{u.src=p.src;u.alt=n.name;e.innerText=n.name;const r=document.createDocumentFragment();if(s.onDemoLinkClicked){const t=document.createElement("a");t.className="free-play";t.innerText=s.translations.demo;t.onclick=()=>s.onDemoLinkClicked(n.gameCode);r.appendChild(t)}const t=document.createElement("a");t.className="play-now";t.dataset.game=n.name;t.href=n.link;t.innerText=s.translations.playNow;r.appendChild(t);f.innerHTML="";f.appendChild(r);$(i).modal()}},r.appendChild(h),r.appendChild(a);else{const u=document.createElement("span");if(u.className="link-container",s.onDemoLinkClicked){const t=document.createElement("a");t.className="free-play";t.innerText=s.translations.demo;t.onclick=()=>s.onDemoLinkClicked(n.gameCode);u.appendChild(t)}h.appendChild(u);const t=document.createElement("a");t.className="play-now";t.dataset.game=n.name;t.href=n.link;t.innerText=s.translations.playNow;u.appendChild(t);const f=document.createElement("input");f.type="radio";f.name="game-list-radio-button";const i=document.createElement("label");i.className="inner-game-item";i.appendChild(f);i.appendChild(h);i.appendChild(w);r.appendChild(i)}y.appendChild(r)});t.appendChild(y);const p=document.createDocumentFragment();v.forEach(n=>{const t=document.createElement("div");t.className="category-filter-link";t.dataset.category=n;t.innerText=n;p.appendChild(t)});n.appendChild(p);const k=t.querySelectorAll(".game-item"),a={name:null,category:null},w=()=>{Array.prototype.slice.call(k).forEach(n=>{const t=n.dataset.game.toLowerCase(),i=n.dataset.category,r=!a.category||i===a.category,u=!a.name||t.indexOf(a.name)>=0;r&&u?$(n).show():$(n).hide()})};$(r).keyup(function(){a.name=r.value.toLowerCase();w()});$(n).on("click",".category-filter-link",function(){const n=$(this);n.siblings().removeClass("active");n.addClass("active");a.category=this.dataset.category;w()});const b=new URLSearchParams(window.location.search).get("PromotionCategory");if(b){const t=Array.from(v).find(n=>n.toLowerCase()===b.toLowerCase());if(t){n.querySelector(`[data-category="${t}"]`).click();return}}}})}});